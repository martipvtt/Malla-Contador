<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Malla Curricular - Contador UNCO</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #f4f7fa;
      color: #333;
      margin: 0;
      padding: 20px;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 10px;
    }
    .year {
      background: #dfe9f3;
      padding: 10px;
      border-radius: 10px;
    }
    .year h2 {
      text-align: center;
      font-size: 1.1em;
      margin-bottom: 10px;
    }
    .subject {
      background: #fff;
      margin: 5px 0;
      padding: 8px;
      border-radius: 6px;
      cursor: pointer;
      border: 2px solid transparent;
      position: relative;
      transition: background 0.3s, border 0.3s;
    }
    .subject.locked {
      background: #eee;
      color: #999;
      cursor: not-allowed;
    }
    .subject.locked::after {
      content: attr(data-tooltip);
      position: absolute;
      top: 100%;
      left: 0;
      width: 200px;
      background: #444;
      color: #fff;
      font-size: 0.8em;
      padding: 5px;
      border-radius: 4px;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s;
      z-index: 2;
    }
    .subject.locked:hover::after {
      opacity: 1;
    }
    .subject.approved {
      background: #abc5ff;
      border-color: #5869b3;
    }
  </style>
</head>
<body>
  <h1>Malla Curricular - Contador Público Nacional (UNCO)</h1>
  <div class="grid" id="malla"></div>

  <script>
    const subjects = {
      1: [
        'Lógica y conocimiento',
        'Instituciones del derecho privado I',
        'Sociología',
        'Matemática I',
        'Introducción a la contabilidad (optativa)',
        'Contabilidad I',
        'Instituciones del derecho público',
        'Introducción a la economía'
      ],
      2: [
        { name: 'Matemática II', req: ['Matemática I'] },
        'Principios de la administración',
        { name: 'Economía I', req: ['Matemática I', 'Introducción a la economía'] },
        { name: 'Instituciones del derecho privado II', req: ['Instituciones del derecho privado I'] },
        { name: 'Contabilidad II', req: ['Matemática I', 'Contabilidad I'] },
        { name: 'Estadística', req: ['Matemática II'] }
      ],
      3: [
        { name: 'Procesamientos electrónico de datos', req: ['Matemática I'] },
        { name: 'Sociedades comerciales', req: ['Instituciones del derecho privado II'] },
        { name: 'Economía II', req: ['Economía I'] },
        { name: 'Matemática financiera', req: ['Matemática I'] },
        { name: 'Finanzas públicas', req: ['Instituciones del derecho público', 'Economía II'] },
        { name: 'Contabilidad III', req: ['Instituciones del derecho privado II', 'Contabilidad II'] },
        { name: 'Actuación profesional en lo laboral y previsional', req: ['Contabilidad I', 'Instituciones del derecho público'] },
        { name: 'Administración financiera', req: ['Matemática financiera'] }
      ],
      4: [
        { name: 'Contabilidad de costos', req: ['Principios de la administración', 'Contabilidad II'] },
        { name: 'Análisis de sistemas', req: ['Principios de la administración'] },
        { name: 'Teoría y técnica tributaria I', req: ['Instituciones del derecho público', 'Contabilidad II', 'Sociedades comerciales'] },
        { name: 'Concursos y quiebras', req: ['Contabilidad II', 'Sociedades comerciales'] },
        { name: 'Contabilidad pública', req: ['Contabilidad II', 'Finanzas públicas'] },
        { name: 'Teoría y técnica tributaria II', req: ['Teoría y técnica tributaria I'] }
      ],
      5: [
        { name: 'Administración gerencial', req: ['Principios de la administración', 'Análisis de sistemas'] },
        { name: 'Auditoría', req: ['Contabilidad de costos', 'Análisis de sistemas', 'Teoría y técnica tributaria II'] },
        { name: 'Ejercicio profesional', req: ['Concursos y quiebras'] },
        { name: 'Análisis de estados', req: ['Contabilidad II', 'Administración financiera', 'Contabilidad de costos'] },
        { name: 'Economía III', req: ['Sociología', 'Economía II'] },
        { name: 'Gestión de empresas', req: ['Estadística', 'Contabilidad de costos'] },
        { name: 'Taller de práctica profesional', req: ['Procesamientos electrónico de datos', 'Actuación profesional en lo laboral y previsional', 'Contabilidad de costos', 'Teoría y técnica tributaria II'] },
        { name: 'Idioma extranjero', req: ['Segundo Año'] }
      ]
    };

    const approved = JSON.parse(localStorage.getItem('aprobadas') || '[]');

    function createSubject(name, requirements = []) {
      const div = document.createElement('div');
      div.className = 'subject';
      div.textContent = name;

      const fulfilled = requirements.every(req => approved.includes(req) || (req === 'Segundo Año' && checkSecondYearComplete()));

      if (approved.includes(name)) {
        div.classList.add('approved');
      } else if (!fulfilled) {
        div.classList.add('locked');
        div.setAttribute('data-tooltip', 'Requiere: ' + requirements.join(', '));
      }

      div.addEventListener('click', () => {
        if (div.classList.contains('locked')) return;

        if (approved.includes(name)) {
          approved.splice(approved.indexOf(name), 1);
          div.classList.remove('approved');
        } else {
          approved.push(name);
          div.classList.add('approved');
        }
        localStorage.setItem('aprobadas', JSON.stringify(approved));
        render();
      });
      return div;
    }

    function checkSecondYearComplete() {
      return subjects[2].every(s => {
        const name = typeof s === 'string' ? s : s.name;
        return approved.includes(name);
      });
    }

    function render() {
      const container = document.getElementById('malla');
      container.innerHTML = '';

      for (let year = 1; year <= 5; year++) {
        const col = document.createElement('div');
        col.className = 'year';

        const title = document.createElement('h2');
        title.textContent = `${year}º Año`;
        col.appendChild(title);

        subjects[year].forEach(s => {
          const subj = typeof s === 'string' ? createSubject(s) : createSubject(s.name, s.req);
          col.appendChild(subj);
        });

        container.appendChild(col);
      }
    }

    render();
  </script>
</body>
</html>
